<template>
  <header id="app-header" class="global-header hide-border-bottom" data-v-8cc44300="">
    <div data-v-26153660="" data-v-8cc44300="" class="global-navigation-bar">
      <!-- 모바일 헤더 -->
      <section data-v-26153660="" class="mobile-header d-lg-none d-xl-none">
        <div data-v-26153660="" class="col-4 mobile-header-col left vue-portal-target">
          <img data-v-26153660="" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIvPgogICAgICAgIDxwYXRoIGQ9Ik00LjUgNmgxNW0tMTUgNmgxNW0tMTUgNmgxNSIgc3Ryb2tlPSIjMkQyRDJEIiBzdHJva2Utd2lkdGg9IjEuNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CiAgICA8L2c+Cjwvc3ZnPgo=" data-testid="side-nav-menu-icon" alt="네비게이션 메뉴 아이콘">
          <a data-v-26153660="" href="/" class="left-logo"> <img data-v-26153660="" src="https://assets.cdn.soomgo.com/icons/logo/navigation_logo.svg" alt="숨고 로고" data-testid="main-logo"> </a>
        </div>
        <div data-v-26153660="" class="col-4 mobile-header-col center vue-portal-target"></div>
        <div data-v-26153660="" class="col-4 mobile-header-col right vue-portal-target"></div>
        <div data-v-4c0deb88="" data-v-26153660="">
          <div data-v-4c0deb88="" data-testid="mobile-usermenu" status="GUEST" class="mobile-usermenu">
            <div data-v-4c0deb88="" class="header">
              <button data-v-4c0deb88="" class="close-button">
                <img data-v-4c0deb88="" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHZpZXdCb3g9IjAgMCAxOCAxOCI+CiAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iYSIgZD0iTTkgNy44NjlMMTYuNDM0LjQzNGwxLjEzMiAxLjEzMkwxMC4xMyA5bDcuNDM1IDcuNDM0LTEuMTMyIDEuMTMyTDkgMTAuMTNsLTcuNDM0IDcuNDM1LTEuMTMyLTEuMTMyTDcuODcgOSAuNDM0IDEuNTY2IDEuNTY2LjQzNCA5IDcuODd6Ii8+CiAgICA8L2RlZnM+CiAgICA8dXNlIGZpbGw9IiMzMjMyMzIiIGZpbGwtcnVsZT0ibm9uemVybyIgeGxpbms6aHJlZj0iI2EiLz4KPC9zdmc+Cg=="></button>
            </div>
            <div data-v-4c0deb88="" class="body">
              <div data-v-4c0deb88="" data-name="user" class="row">
                <div data-v-4c0deb88="" data-name="user-info" role="button" class="col">
                  <h4 data-v-4c0deb88="">로그인 해주세요</h4>
                  <p data-v-4c0deb88="" data-testid="login-btn"> 로그인
                    <img data-v-4c0deb88="" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2IiBoZWlnaHQ9IjEwIiB2aWV3Qm94PSIwIDAgNiAxMCI+CiAgICA8cGF0aCBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHN0cm9rZT0iIzRENEY1NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9Ii44IiBkPSJNMSAxbDQgNC00IDQiLz4KPC9zdmc+Cg==" alt="arrow" class="angle-icon">
                  </p>
                </div>
                <div data-v-4c0deb88="" data-name="user-profile" class="col-auto"></div>
              </div>
              <nav data-v-4c0deb88="" class="gnb-list">
                <ul data-v-4c0deb88="" class="user-menu">
                  <li data-v-4c0deb88="" class="nav-item">
                    <a data-v-4c0deb88="" href="/pro?entry_point=signup_cta" class="gnb-link">
                      <span data-v-4c0deb88="" class="menu-title">기업가입</span>
                    </a>
                  </li>
                  <li data-v-4c0deb88="" class="nav-item">
                    <a data-v-4c0deb88="" href="/sign-up?from=gnb&amp;entry_point=signup_cta" class="gnb-link">
                      <span data-v-4c0deb88="" class="menu-title">회원가입</span>
                    </a>
                  </li>
                </ul>
                <ul data-v-4c0deb88="" class="service-menu">
                  <li data-v-4c0deb88="" class="nav-item">
                    <a data-v-4c0deb88="" href="/category-home?from=mobile_web_hamburger" class="lnb-link">
                      <span data-v-4c0deb88="" class="menu-title">견적요청</span>
                    </a>
                  </li>
                  <li data-v-4c0deb88="" class="nav-item">
                    <a data-v-4c0deb88="" href="/search/pro?from=mobile_web_hamburger" class="lnb-link">
                      <span data-v-4c0deb88="" class="menu-title">팝업찾기</span>
                    </a>
                  </li>
                  <li data-v-4c0deb88="" class="nav-item">
                    <a data-v-4c0deb88="" href="/market/?location=mobile_web_hamburger" class="lnb-link">
                      <span data-v-4c0deb88="" class="menu-title">굿즈마켓</span>
                    </a>
                  </li>
                  <li data-v-4c0deb88="" class="nav-item">
                    <a data-v-4c0deb88="" href="/community/soomgo-life/?from=mobile_web_hamburger" class="lnb-link">
                      <span data-v-4c0deb88="" class="menu-title">커뮤니티</span>
                    </a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </section>
      <!-- 데스크탑 헤더 -->
      <section data-v-26153660="" class="d-none d-lg-block d-xl-block">
        <div data-v-26153660="" class="desktop-header">
          <div data-v-26153660="" class="left-section">
            <div data-v-26153660="" class="logo">
              <a data-v-26153660="" href="/" class="">
                <img data-v-26153660="" src="https://assets.cdn.soomgo.com/icons/logo/navigation_logo.svg" alt="숨고, 숨은고수">
              </a>
            </div>
            <nav data-v-26153660="">
              <ul data-v-26153660="" class="nav-list">
                <li data-v-26153660="" class="nav-item left-section-item">
                  <a data-v-26153660="" href="/search/pro?from=web_gnb" class="gnb-link">
                    <span data-v-26153660="">팝업찾기</span>
                  </a>
                </li>
                <li data-v-26153660="" class="nav-item left-section-item">
                  <a data-v-26153660="" href="/market/" class="gnb-link">
                    <span data-v-26153660="">굿즈마켓</span>
                  </a>
                </li>
                <li data-v-26153660="" class="nav-item left-section-item">
                  <a data-v-26153660="" href="/community/post-all" class="gnb-link">
                    <span data-v-26153660="">커뮤니티</span>
                  </a>
                </li>
              </ul>
            </nav>
          </div>
          <div data-v-26153660="" class="center-section"></div>
          <!-- 로그인 안함  -->
          <div v-show="userStatus == false" data-v-26153660="" class="right-section">
            <nav data-v-26153660="">
              <ul data-v-26153660="" class="nav-list">
                <li data-v-26153660="" class="n av-item right-section-item">
                  <span data-v-26153660="">
                    <router-link to="/login">로그인</router-link>
                  </span>
                </li>
                <li data-v-26153660="" class="nav-item right-section-item">
                  <span data-v-26153660="">
                    <router-link to="/signup/customer">회원가입</router-link>
                  </span>
                </li>
              </ul>
            </nav>
            <button data-v-26153660="" type="button" class="btn pro-signup-btn right-section-item btn-primary">
              <router-link to="/signup/company">기업가입</router-link>
            </button>
          </div>
          <!-- 로그인 함 -->
          <div v-show="userStatus == true" data-v-26153660="" class="right-section">
            <nav data-v-26153660="">
              <ul data-v-26153660="" class="nav-list">
                <li data-v-26153660="" class="nav-item right-section-item">
                  <a @click="redirectToMypage" class="gnb-link">
                    <span data-v-26153660="">마이페이지</span>
                  </a>
                </li>
                <li data-v-26153660="" class="nav-item right-section-item">
                    <a data-v-26153660="" href="/cart" class="gnb-link">
                        <span data-v-26153660="">장바구니</span>
                    </a>
                </li>
                <li data-v-26153660="" class="nav-item right-section-item">
                  <a data-v-26153660="" href="/wish_popup" class="gnb-link">
                    <span data-v-26153660="">찜한팝업</span>
                  </a>
                </li>
                <li data-v-26153660="" class="nav-item right-section-item">
                  <a data-v-26153660="" href="/chats" class="gnb-link">
                    <span data-v-26153660="">채팅</span>
                  </a>
                </li>
                <button v-if="userStatus" @click="handleLogout" data-v-26153660="" class="btn pro-signup-btn right-section-item btn-primary"> 로그아웃 </button>
              </ul>
            </nav>
            <div data-v-35a09b99="" data-v-26153660="" class="usermenu user-menu right-section-item">
              <div data-v-35a09b99="" class="usermenu-button">
                <div data-v-29d5164e="" data-v-35a09b99="" class="user-profile-picture">
                  <div data-v-29d5164e="" data-name="image" class="" data-src="https://static.cdn.soomgo.com/upload/profile-default/soomgo_130.jpg?h=320&amp;w=320&amp;webp=1" lazy="loaded" style="background-image: url(&quot;https://static.cdn.soomgo.com/upload/profile-default/soomgo_130.jpg?h=320&amp;w=320&amp;webp=1&quot;);">
                  </div>
                </div>
                <img data-v-35a09b99="" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAxMiAxMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgxMnYxMkgweiIvPgogICAgICAgIDxwYXRoIHN0cm9rZT0iIzg4OCIgc3Ryb2tlLXdpZHRoPSIxLjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0iTTEwIDQgNiA4IDIgNCIvPgogICAgPC9nPgo8L3N2Zz4K">
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </header>
  <div id="app-sticky-nav" class="vue-portal-target"></div>
</template>


<script>
import { useAuthStore } from '@/stores/useAuthStore';
import { mapStores } from 'pinia';

export default {
  name: "HeaderComponent",
  props: ["userStatus"],
  computed: {
    ...mapStores(useAuthStore)
  },
  methods: {
    async handleLogout() {
      try {
        if (await this.memberStore.logout()) {
          this.$router.push('/')
        }
      } catch (error) {
        console.error("Logout error:", error);
      }
    },
    getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length === 2) return parts.pop().split(';').shift();
    },
    redirectToMypage() {
      const utoken = this.getCookie('UTOKEN');
      if (utoken) {
        const userRole = utoken.split('|')[1];
        if (userRole === 'ROLE_COMPANY') {
          this.$router.push('/managermypage');
        } else if (userRole === 'ROLE_CUSTOMER') {
          this.$router.push('/mypage');
        } else {
          this.$router.push('/mypage'); // Default fallback if role is not matched
        }
      } else {
        this.$router.push('/mypage'); // Default fallback if token is not found
      }
    }
  }
}
</script>


<style scoped></style>